<nav class="toc">
  <h2>目次</h2>
  <ul id="toc-list"></ul>
</nav>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const tocList = document.getElementById("toc-list");
    const container = document.querySelector(".post-body"); // ← ここ！

    if (!container) return;

    const headings = container.querySelectorAll("h2, h3");

    headings.forEach(heading => {
      const text = heading.textContent;
      const existingId = heading.id;
      const id = existingId || text.toLowerCase().replace(/[^\w]+/g, "-");

      if (!existingId) heading.id = id;

      const li = document.createElement("li");
      li.className = heading.tagName.toLowerCase();

      const a = document.createElement("a");
      a.href = `#${id}`;
      a.textContent = text;

      li.appendChild(a);
      tocList.appendChild(li);
    });
  });
</script>
